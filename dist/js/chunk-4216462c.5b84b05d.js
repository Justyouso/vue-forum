(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4216462c"],{b3bf:function(e,t,r){},d9c9:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"login"}},[r("div",{staticClass:"login-wrap"},[r("ul",{staticClass:"menu-tab"},e._l(e.menuTab,(function(t){return r("li",{key:t.id,class:{current:t.current},on:{click:function(r){return e.toggleMenu(t)}}},[e._v(e._s(t.txt))])})),0),r("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,size:"medium"}},[r("el-form-item",{staticClass:"item-form",attrs:{prop:"email"}},[r("label",{attrs:{for:"email"}},[e._v("邮箱")]),r("el-input",{attrs:{id:"email",type:"text",autocomplete:"off"},model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"register"===e.model,expression:"model === 'register'"}],staticClass:"item-form",attrs:{prop:"username"}},[r("label",{attrs:{for:"username"}},[e._v("用户名")]),r("el-input",{attrs:{id:"username",type:"text",autocomplete:"off",minlength:"6",maxlength:"20"},model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),r("el-form-item",{staticClass:"item-form",attrs:{prop:"password"}},[r("label",{attrs:{for:"password"}},[e._v("密码")]),r("el-input",{attrs:{id:"password",type:"password",autocomplete:"off",minlength:"6",maxlength:"20"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"register"===e.model,expression:"model === 'register'"}],staticClass:"item-form",attrs:{prop:"passwords"}},[r("label",{attrs:{for:"passwords"}},[e._v("重复密码")]),r("el-input",{attrs:{id:"passwords",type:"password",autocomplete:"off",minlength:"6",maxlength:"20"},model:{value:e.ruleForm.passwords,callback:function(t){e.$set(e.ruleForm,"passwords",t)},expression:"ruleForm.passwords"}})],1),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"register"===e.model,expression:"model === 'register'"}],staticClass:"item-form",attrs:{prop:"code"}},[r("label",{attrs:{for:"code"}},[e._v("验证码")]),r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:15}},[r("el-input",{attrs:{id:"code"},model:{value:e.ruleForm.code,callback:function(t){e.$set(e.ruleForm,"code",t)},expression:"ruleForm.code"}})],1),r("el-col",{attrs:{span:9}},[r("el-button",{staticClass:"block",attrs:{type:"success",disabled:e.codeButtonStatus.status},on:{click:function(t){return e.getSms()}}},[e._v(e._s(e.codeButtonStatus.text))])],1)],1)],1),"login"===e.model?r("router-link",{attrs:{to:"/pwd/edit"}},[e._v("忘记密码")]):e._e(),r("el-form-item",[r("el-button",{staticClass:"login-btn block",attrs:{type:"danger"},on:{click:function(t){return e.submitForm("loginForm")}}},[e._v(e._s("login"===e.model?"登陆":"注册"))])],1)],1)],1)])},s=[],a=(r("4160"),r("159b"),r("6199"),r("7ded")),n=r("61f7"),i={name:"login",data:function(){var e=this,t=function(e,t,r){""===t?r(new Error("请输入邮箱")):Object(n["b"])(t,"email")?r():r(new Error("邮箱格式错误"))},r=function(t,r,o){if("login"==e.model&&o(),e.ruleForm.username=Object(n["a"])(r),r=Object(n["a"])(r),!r)return o(new Error("请输入用户名"));Object(n["b"])(r,"username")?o():o(new Error("密码为6至20位数字+字母"))},o=function(t,r,o){if(e.ruleForm.password=Object(n["a"])(r),r=Object(n["a"])(r),!r)return o(new Error("请输入密码"));Object(n["b"])(r,"pwd")?o():o(new Error("密码为6至20位数字+字母"))},s=function(t,r,o){if("login"==e.model&&o(),e.ruleForm.passwords=Object(n["a"])(r),r=Object(n["a"])(r),!r)return o(new Error("请输入密码"));r!=e.ruleForm.password?o(new Error("重复密码错误")):o()},a=function(t,r,o){"login"==e.model&&o(),e.ruleForm.code=Object(n["a"])(r),r=Object(n["a"])(r),""===r?o(new Error("请输入验证码")):Object(n["b"])(r,"code")?o():o(new Error("验证码格式错误"))};return{menuTab:[{txt:"登陆",current:!1,type:"login"},{txt:"注册",current:!1,type:"register"}],model:"login",codeButtonStatus:{status:!1,text:"发送验证码"},ruleForm:{email:"",username:"",password:"",passwords:"",code:""},rules:{email:[{validator:t,trigger:"blur"}],username:[{validator:r,trigger:"blur"}],password:[{validator:o,trigger:"blur"}],passwords:[{validator:s,trigger:"blur"}],code:[{validator:a,trigger:"blur"}]},timer:null}},methods:{toggleMenu:function(e){this.menuTab.forEach((function(e){e.current=!1})),e.current=!0,this.model=e.type,this.resetForm(),this.clearCountDown()},resetForm:function(){this.$refs["loginForm"].resetFields()},updateCodeButtonStatus:function(e){this.codeButtonStatus.status=e.status,this.codeButtonStatus.text=e.text},getSms:function(){var e=this;if(""==this.ruleForm.email)return this.$message.error("邮箱不能为空!"),!1;if(!Object(n["b"])(this.ruleForm.email,"email"))return this.$message.error("邮箱格式错误!"),!1;this.updateCodeButtonStatus({status:!0,text:"发送中"});var t={email:this.ruleForm.email,module:this.model};Object(a["a"])(t).then((function(t){var r=t.data;e.$message({message:r.message,type:"success"}),e.countDown(60)})).catch((function(t){e.updateCodeButtonStatus({status:!1,text:"发送验证码"}),console.log(t)}))},countDown:function(e){var t=this;this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){e--,0===e?(clearInterval(t.timer),t.updateCodeButtonStatus({status:!1,text:"重新发送"})):t.updateCodeButtonStatus({status:!0,text:"倒计时".concat(e,"秒")})}),1e3)},clearCountDown:function(){this.updateCodeButtonStatus({status:!1,text:"获取验证码"}),clearInterval(this.timer)},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;"login"===t.model?t.login():t.register()}))},login:function(){var e=this,t={email:this.ruleForm.email,password:this.ruleForm.password};Object(a["b"])(t).then((function(t){var r=t.data.data;e.$store.commit("SET_USERINFO",r),e.$store.commit("SET_ISLIVE",!0),e.clearCountDown(),e.$router.push({name:"IndexNew"})})).catch((function(e){console.log(e)}))},register:function(){var e=this,t={email:this.ruleForm.email,username:this.ruleForm.username,password:this.ruleForm.password,code:this.ruleForm.code,module:"register"};Object(a["d"])(t).then((function(t){e.clearCountDown()})).catch((function(e){}))}},created:function(){this.model="login",this.$route.query.model&&(this.model=this.$route.query.model)}},l=i,u=(r("ee09"),r("2877")),m=Object(u["a"])(l,o,s,!1,null,"46b0bb48",null);t["default"]=m.exports},ee09:function(e,t,r){"use strict";var o=r("b3bf"),s=r.n(o);s.a}}]);